2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Current SDK version is 0.17.6
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Configure stats pid to 4605
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Loading settings from /Users/aw/.config/wandb/settings
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Loading settings from /Users/aw/projects/vitsearch/wandb/settings
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_init.py:_log_setup():521] Logging user logs to /Users/aw/projects/vitsearch/wandb/run-20240810_150314-h5d7rejr/logs/debug.log
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_init.py:_log_setup():522] Logging internal logs to /Users/aw/projects/vitsearch/wandb/run-20240810_150314-h5d7rejr/logs/debug-internal.log
2024-08-10 15:03:14,591 INFO    MainThread:4605 [wandb_init.py:_jupyter_setup():467] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x30d3da2d0>
2024-08-10 15:03:14,592 INFO    MainThread:4605 [wandb_init.py:init():559] calling init triggers
2024-08-10 15:03:14,593 INFO    MainThread:4605 [wandb_init.py:init():566] wandb.init called with sweep_config: {}
config: {'model_name': 'laion/CLIP-ViT-L-14-DataComp.XL-s13B-b90K', 'model_class_name': 'HookedTransformer', 'hook_point': 'blocks.{layer}.hook_mlp_out', 'hook_point_eval': 'blocks.{layer}.attn.pattern', 'hook_point_layer': [23], 'hook_point_head_index': None, 'dataset_path': 'imagenet_data', 'streaming': True, 'is_dataset_tokenized': True, 'context_size': 257, 'use_cached_activations': False, 'cached_activations_path': None, 'd_in': 1024, 'd_sae': 32768, 'b_dec_init_method': 'geometric_median', 'expansion_factor': 32, 'activation_fn': 'relu', 'normalize_sae_decoder': True, 'noise_scale': 0.0, 'from_pretrained_path': None, 'apply_b_dec_to_input': True, 'decoder_orthogonal_init': False, 'decoder_heuristic_init': False, 'init_encoder_as_decoder_transpose': False, 'n_batches_in_buffer': 4, 'training_tokens': 3447141, 'finetuning_tokens': 0, 'store_batch_size_prompts': 32, 'train_batch_size_tokens': 4, 'normalize_activations': False, 'device': device(type='mps'), 'seed': 42, 'dtype': torch.float32, 'prepend_bos': True, 'autocast': False, 'compile_llm': False, 'llm_compilation_mode': None, 'compile_sae': False, 'sae_compilation_mode': None, 'adam_beta1': 0, 'adam_beta2': 0.999, 'mse_loss_normalization': None, 'l1_coefficient': 8e-05, 'lp_norm': 1, 'scale_sparsity_penalty_by_decoder_norm': False, 'l1_warm_up_steps': 0, 'lr': 0.0004, 'lr_scheduler_name': 'constant', 'lr_warm_up_steps': 5000, 'lr_end': 4e-05, 'lr_decay_steps': 0, 'n_restart_cycles': 1, 'finetuning_method': None, 'use_ghost_grads': True, 'feature_sampling_window': 1000, 'dead_feature_window': 5000, 'dead_feature_threshold': 1e-08, 'n_eval_batches': 10, 'eval_batch_size_prompts': None, 'log_to_wandb': True, 'log_activations_store_to_wandb': False, 'log_optimizer_state_to_wandb': False, 'wandb_project': 'openclip_sae_training', 'wandb_id': None, 'run_name': '32768-L1-8e-05-LR-0.0004-Tokens-2.000e+06', 'wandb_entity': 'willfulbytes', 'wandb_log_frequency': 100, 'eval_every_n_wandb_logs': 10, 'resume': False, 'n_checkpoints': 10, 'checkpoint_path': 'None/si4dbgo2', 'verbose': True, 'model_kwargs': {}, 'model_from_pretrained_kwargs': {}, 'sae_lens_version': '2.1.3', 'sae_lens_training_version': '2.1.3', 'num_workers': 0, 'num_epochs': 1, 'model_base': 'ViT-L-14', 'model_pretrained': 'datacomp_xl_s13b_b90k', 'store_batch_size': 4, 'tokens_per_buffer': 4112}
2024-08-10 15:03:14,594 INFO    MainThread:4605 [wandb_init.py:init():609] starting backend
2024-08-10 15:03:14,594 INFO    MainThread:4605 [wandb_init.py:init():613] setting up manager
2024-08-10 15:03:14,595 INFO    MainThread:4605 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-08-10 15:03:14,597 INFO    MainThread:4605 [wandb_init.py:init():621] backend started and connected
2024-08-10 15:03:14,619 INFO    MainThread:4605 [wandb_run.py:_label_probe_notebook():1337] probe notebook
2024-08-10 15:03:14,620 INFO    MainThread:4605 [wandb_run.py:_label_probe_notebook():1347] Unable to probe notebook: 'NoneType' object has no attribute 'get'
2024-08-10 15:03:14,621 INFO    MainThread:4605 [wandb_init.py:init():716] updated telemetry
2024-08-10 15:03:14,638 INFO    MainThread:4605 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-08-10 15:03:14,898 INFO    MainThread:4605 [wandb_run.py:_on_init():2438] communicating current version
2024-08-10 15:03:14,993 INFO    MainThread:4605 [wandb_run.py:_on_init():2447] got version response 
2024-08-10 15:03:14,993 INFO    MainThread:4605 [wandb_init.py:init():800] starting run threads in backend
2024-08-10 15:03:15,720 INFO    MainThread:4605 [wandb_run.py:_console_start():2416] atexit reg
2024-08-10 15:03:15,720 INFO    MainThread:4605 [wandb_run.py:_redirect():2258] redirect: wrap_raw
2024-08-10 15:03:15,720 INFO    MainThread:4605 [wandb_run.py:_redirect():2323] Wrapping output streams.
2024-08-10 15:03:15,720 INFO    MainThread:4605 [wandb_run.py:_redirect():2348] Redirects installed.
2024-08-10 15:03:15,722 INFO    MainThread:4605 [wandb_init.py:init():843] run started, returning control to user process
2024-08-10 15:13:35,967 WARNING MsgRouterThr:4605 [router.py:message_loop():77] message_loop has been closed
2024-08-10 15:13:40,802 INFO    MainThread:4605 [jupyter.py:save_ipynb():372] not saving jupyter notebook
2024-08-10 15:13:40,802 INFO    MainThread:4605 [wandb_init.py:_pause_backend():432] pausing backend
